IEEE TRANSACTIONS ON NETWORK SCIENCE AND ENGINEERING, VOL. 11, NO. 1, JANUARY/FEBRUARY 2024 543
DecAge: Decentralized Flow Scheduling for
Industrial 5G and TSN Integrated Networks
Mingyan Li , Songtao Guo , Senior Member, IEEE, Chao Chen , Senior Member, IEEE, Cailian Chen , Senior Member, IEEE, Xiaofeng Liao , Fellow, IEEE, and Xinping Guan , Fellow, IEEE
Abstract—The integration of fifth-generation (5G) and timesensitive networking (TSN) is a key technology to promote the wireless upgrade of manufacturing industry, and some preliminary enhancements on 5G with TSN-integration have been introduced to empower industrial internet ubiquitous connectivity and real-time forwarding. However, at present, the 5G system is only served as a logical bridge with 5G-specific procedures hidden from TSN networks, and thus the deep integration of 5G and TSN is still an open issue. This article focuses on the co-design problem of flow scheduling in 5G and TSN, where 5G grant-free configured-grants (CGs) and TSN cyclic queuing and forwarding mechanisms are adopted. Firstly, we innovatively propose to achieve seamless 5G+TSN transmission by intelligently selecting CGs in 5G, where the starting time offsets of different CGs will influence the flow injection time in the downstream TSN network to mitigate the queue overflow issue. Then, an age-of-information (age) aware decentralized and deterministic scheduling (DecAge) scheme based on actor-critic reinforcement learning is proposed. DecAge guides time-sensitive flow hosts to autonomously make packet sampling-transmission decisions so that timeliness-based age constraints can be respected via collision-free 5G+TSN transmission. DecAge contains multiple local actors learning hierarchically-structured scheduling policies for flow hosts and a central graph attention network-based critic to estimate these policies. Through simulation, DecAge shows the robustness to environmental non-stationarity by elaborately coordinating distributed learning and yields improved performance over non-hierarchical agents on sample-efficient learning.
Index Terms—5G+TSN flow scheduling, grant-free CGs, cyclic queuing and forwarding, multi-agent reinforcement learning.
Manuscript received 29 January 2023; revised 5 June 2023; accepted 29 July 2023. Date of publication 9 August 2023; date of current version 8 January 2024. This work was supported in part by the National Natural Science Foundation of China under Grants 62203077, 62272069 and 62172066, in part by the Natural Science Foundation of Chongqing under Grant CSTB2022NSCQ-MSX1029, in part by the Special Research Funding for Chongqing Postdoctoral Researchers under Grant 2021XM2015, in part by the Fundamental Research Funds for the Central Universities under under Grants 2022CDJXY-020 and 2023CDJXY038, and in part by the Open Project of Key Laboratory of System Control and Information Processing, Ministry of Education. Recommended for acceptance by Dr. Tie Qiu. (Corresponding author: Songtao Guo.)
Mingyan Li is with the College of Computer Science, Chongqing University, Chongqing 400044, China, and also with the Key Laboratory of System Control and Information Processing, Ministry of Education, Shanghai 200241, China (e-mail: limy2021@cqu.edu.cn). Songtao Guo, Chao Chen, and Xiaofeng Liao are with the College of Computer Science, Chongqing University, Chongqing 400044, China (e-mail: guosongtao@cqu.edu.cn; cschaochen@cqu.edu.cn; xfliao@cqu.edu.cn). Cailian Chen and Xinping Guan are with the Department of Automation, Shanghai Jiao Tong University, Shanghai 200240, China (e-mail: cailianchen@sjtu.edu.cn; xpguan@sjtu.edu.cn). Digital Object Identifier 10.1109/TNSE.2023.3301879
I. INTRODUCTION
I
NDUSTRIAL Internet of Things (IIoT) is an important support for the fourth industrial revolution, where time-sensitive networking (TSN) technology can promise the deterministic interaction of time-critical tasks based on a series of strict traffic scheduling protocols [1]. To further realize ubiquitous sensing and flexible manufacturing, the standardized enhancement of the fifth-generation (5G) New Radio has been proposed in 3GPP Release 16 (R16) for TSN requirements in the scenario of IIoT. By introducing time-sensitive communication, the 5G system serves as a logical bridge to provide TSN Ethernet ingress and egress ports on the user plane using the “Translator” functions [2], as shown in Fig. 1. However, TSN relies on time-domain access whereas 5G exploits frequency-domain user multiplexing. This scheduling resolution mis-match calls for hold-and-forward mechanisms at the edge of 5G system, which impede the seamless transmission of 5G and TSN. A key way to integrate 5G and TSN is re-using the ultrareliable and low-latency communication (URLLC) framework, where the grant-free (GF) transmission has been introduced in R16 for 5G uplinks based on multiple configured-grants (CGs) transmission resources with different starting time offsets [3]. In this way, URLLC users can autonomously choose any of these pre-configured CGs to transmit as soon as data arrives. Compared with the request-followed by-grant procedure in the conventional centralized dynamic scheduling, this arrive-andgo manner can largely reduce transmission latency [4]. Due to the decentralized nature of GF transmission, users compete CG resources randomly, leading to blind detection of active users in the base station (BS). As a result, transmission conflict may happen. Hence, non-orthogonal multiple access (NOMA) has been proposed to synergize with GF transmission to mitigate network congestion, referred to as GF-NOMA [5], [6], [7], [8], [9], [10]. For the 5G+TSN integrated networks, GF-NOMA enhancements are further required to guarantee the end-to-end timeliness constraints, which calls for the consideration of TSN scheduling. As an ethernet protocol extension developed by IEEE 802.1 TSN task group, TSN introduces many time-aware traffic shapers like time-aware shaper (TAS) to guarantee the deterministic forwarding for periodic time-sensitive flows [11]. TAS assigns time slots to each time-triggered flow and each flow transmits data only during its assigned time slot. Therefore, it requires finegrained configurations of the gate control list (GCL) attached to
2327-4697 © 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information.
Authorized licensed use limited to: GUANGZHOU UNIVERSITY. Downloaded on September 25,2024 at 03:00:57 UTC from IEEE Xplore. Restrictions apply.


544 IEEE TRANSACTIONS ON NETWORK SCIENCE AND ENGINEERING, VOL. 11, NO. 1, JANUARY/FEBRUARY 2024
Fig. 1. Illustration of 5G+TSN integrated networks.
each queue in a TSN switch to enforce temporal isolation of flows [12]. To simplify the design of a TSN switch, a Ping-Pong queuebased model named cyclic queuing and forwarding (CQF) was proposed in IEEE 802.1 Qch for aperiodic and periodic flows. CQF installs static configurations on GCL to assign cyclic en-queue and de-queue operations, as shown in Fig. 1 [13]. As a result, the complex time scheduling for each queue can be ignored, and multiple flows are aggregated into the same queue without considering the input and output time sequences of packets as long as the usage of queues on the path of these flows does not exceed their capacity. However, many flows would converge in parts of queues if being forwarded without an elaborated planning of sending time [14]. Therefore, several injection time planning strategies were proposed based on incremental heuristics to avoid queue overflow [15], [16], [17], [18]. By delaying the sending time slots of flows with offsets, a balanced queue utilization can be achieved. Motivated by these CQF-based works, we provide a novel idea for the studies on seamless and collision-free 5G+TSN transmission by jointly designing the time offsets of GF access in 5G and flow injection in TSN. To the best of our knowledge, this is the first work to deal with the flow scheduling resolution mis-match issue for 5G+TSN integration.
A. Bi-Objective for Age-Aware 5G+TSN Flow Scheduling
This article addresses the flow scheduling co-design problem of 5G and TSN for industrial monitoring services with status update traffic flows. For timely status update, the ageof-information, referred to as age, is optimized, which captures the timeliness from the perspective of destinations [19]. Age is a crucial metric for industrial services to assist remote controllers taking up-to-date decisions. Different from the metric of delay or latency, age captures the information freshness from destinations’ perspective rather than packets’ perspective. Specifically, age optimization relies on both packet sampling and transmission decisions of flow hosts (a.k.a. flows), which are generally referred to as scheduling actions. Therefore, in our problem, multiple age-aware flows make scheduling actions
based on the principles of 5G GF-NOMA and TSN CQF under the following bi-objective objective.
Age-constraint guarantee with minimal power: The primal objective is to respect flows’ age constraints and minimize the sampling-transmission energy consumption. To this end, the secondary transmission objective should be achieved if a packet is sampled.
Collision-free 5G+TSN transmission: Flow transmission in both 5G and TSN should be jointly optimized by elaborately selecting the grant-free CGs so that,
 flows can be successfully detected and decoded in 5G;
 based on the no-wait injection principle in the BS, flows can be mapped onto the underlying orthogonal resources of Ping-Pong queues in TSN switches both temporally and spatially to avoid queue overflow.
B. Challenge and Contribution
Challenge: This age-aware flow scheduling co-design problem is challenging due to the following aspects: i) Stochasticity: The outcome of age evolution is stochastic under environment uncertainty (unknown channel state and communication interference). Therefore, flows need to consider the expected outcome when deciding which action to execute so as to respect their age constraints. ii) Decentrality: Due to the decentralized nature of GF transmission, individual flows autonomously access the network without any priority of planning, where scheduling policies are optimized with partial observability. As a result, the state transition of a flow is uncertainty due to other concurrently-exploring flows, and thus the environment is perceived as non-stationary. iii) Complex reasoning: According to the above bi-objective, flows infer the effect of scheduling actions from the feedback of age, which is a coupled result of sampling and transmission decisions. Moreover, the transmission performance of 5G and TSN should be jointly optimized by just controlling the operating CGs. Contribution: To deal with these challenges, an age-aware decentralized and deterministic scheduling (DecAge) scheme based on deep reinforcement learning (DRL) is proposed for 5G+TSN integrated networks, and the major contributions of this article are summarized as follows.
 Age-aware co-design of 5G+TSN scheduling: To solve Challenge (i), an age-aware flow deterministic scheduling (AgeDS) problem is formulated with flow age constraints and TSN queue constraints. In this problem, we firstly propose to jointly design the collision-free GF access of 5G and flow injection of TSN by optimizing the selection of CGs based on their time slot offsets. Then, primal-dual learning is utilized to deal with environment uncertainty and stochasticity in the dual domain of AgeDS problem.
 Decentralized multi-agent RL with GAT-based critic: The challenge of non-stationary non-Markovian environments, i.e., Challenge (ii), may cause instability learning. Based on the centralized training with decentralized execution
Authorized licensed use limited to: GUANGZHOU UNIVERSITY. Downloaded on September 25,2024 at 03:00:57 UTC from IEEE Xplore. Restrictions apply.


LI et al.: DECAGE: DECENTRALIZED FLOW SCHEDULING FOR INDUSTRIAL 5G AND TSN INTEGRATED NETWORKS 545
Fig. 2. Illustration of age-aware 5G+TSN scheduling co-design with an example.
TABLE I THE LIST OF KEY ABBREVIATIONS
paradigm in multi-agent RL, a central critic with variancereducing baselines is used in DecAge to estimate the performance of distributed scheduling policies from a global and long-term perspective, which is trained by the graph attention network (GAT) with an augmented adjacency graph. It considers the flows that may impose interference in both 5G and TSN so that the critic can dynamically attend to the relevant information from them.
 Hierarchical scheduling with adjacent state awareness: According to Challenge (iii), sampling-transmission actions are jointly optimized. As a result, scheduling policies are learned with sparse rewards of communication. Based on this hierarchy, two-tiered sample-efficient architecture is proposed, containing an age-aware high-level sampling policy and a communication-oriented low-level skill. The former outputs the transmission desire, serving as a subgoal for the latter. Moreover, local observation is expanded with state prediction of adjacent flows, which further coordinates the behavior of distributed flows. The key abbreviations and notations are listed in Table I and Table II, respectively. The remainder of this paper is organized as follows. We firstly introduce the 5G+TSN integrated network as well as the scheme overview in Section II. Then, the system model and problem formulation are proposed in Section III with the detail of DecAge introduced in Section IV. The simulation is provided in Section V and Section VI discusses the related work of GF-NOMA, Finally, Section VII concludes this article.
II. OVERVIEW
A. 5G+TSN Integrated Network
The 5G+TSN transmission is composed of GF-NOMA uplink transmission in 5G and multi-hop CQF-based forwarding in
TABLE II THE LIST OF KEY NOTATIONS
TSN. Firstly, the 5G New Radio frame structure and GF-NOMA with multiple CGs are introduced.
Frame structure and GF-NOMA: From the temporal dimension, the transmission latency of 5G can be reduced by shortening transmission time interval (TTI) with mini-slots. Depending on the numerology factor μ, a subframe, indexed by t, can have 2μ time slots (indexed by τ ), as depicted in Fig. 2(a) with μ = 3.1 From the spatial dimension, distributed flows for status sensing are located in the Euclidean plane and their GF uplink transmissions are taken place over a shared spectrum where they may interfere with each other. To mitigate flow collision in GF transmission, the BS pre-configures multiple CGs at each subframe, mainly featured by different resource starting offsets in the unit of time slots. The BS detects flows and decodes their packets in each subframe using NOMA so that the number of served flows can be improved. CQF-based forwarding: According to CQF, there are two Ping-Pong queues in each TSN gateway and switch (e.g., timesensitive queues Q6 and Q7 in the Fig. 2(b)) performing enqueue and de-queue operations in a cyclic manner. In this way, the packet enqueued in the previous slot will be dequeued in the current slot and received in the next-hop TSN switch at the same time. Based on early-stage analysis, flow injecting time to the TSN network has a critical effect on queue utilization of switches. Hence, for seamless 5G+TSN transmission, the operating CG of flows in the upstream 5G system should be carefully designed to avoid queue overflow in TSN.
1With the subcarrier spacing Δf = 2μ × 15kHz, where μ = 0, 1, 2, 3, 4, the
slot duration reduces according to 1/2μ (ms) [7].
Authorized licensed use limited to: GUANGZHOU UNIVERSITY. Downloaded on September 25,2024 at 03:00:57 UTC from IEEE Xplore. Restrictions apply.


546 IEEE TRANSACTIONS ON NETWORK SCIENCE AND ENGINEERING, VOL. 11, NO. 1, JANUARY/FEBRUARY 2024
Example: To stress it clear, we build an example with queue length set to 1 in Fig. 2(c) where two time-sensitive flows (f1 and f2) have an overlapping path (SW0 → SW1). If there is no slot offset between f1 and f2, the packet of f2 will be dropped due to the limited queue length. Nevertheless, if the flow host of f2 choose to transmit through CG2 with one slot offset, all packets can reach SW1 successfully. As the resource utilization of both 5G and TSN improves, the number of flows respecting their age constraints grows up.
B. Scheme Overview
To this end, we propose our scheduling scheme, DecAge, with its framework delineated in Fig. 2. DecAge consists of multiple local Flowactors and an Edgecritic. On the one hand, Flowactors are in charge of flow scheduling decision making for their corresponding flow hosts, i.e., packet sampling for timely status update (age-aware sampling) and 5G+TSN transmission if a packet sampled. On the other hand, the central Edgecritic is located in the BS with edge computing servers, where the BS decodes packets received via wireless 5G GF uplinks and injects them into the TSN network. Edgecritic is responsible for estimating the scheduling policies of local Flowactors from a global long-term view and re-injecting the packets if overflow events have been foreseen based on the deterministic forwarding property of TSN.
III. SYSTEM MODEL AND PROBLEM FORMULATION
Before introducing the detail of DecAge, the system model and problem formulation are proposed in the next.
A. System Model
Consider multiple time-sensitive monitoring systems in an integrated 5G+TSN deployment of industrial environments, where aperiodic age-aware flows are generated by the corresponding hosts, denoted as the flow set F with |F| = F . Each flow fi ∈ F generates status packets requiring stringently fresh data. It is captured by the metric of age, which measures the time elapsed since the generation of the packet that was most recently delivered to destination [19]. Formally, the age of a monitoring system (a.k.a. a flow fi for simplicity) at subframe t is defined as gi,t. Let each flow fi be characterized by an age constraint with age limit fi.age. Besides, the flow feature also consists of source and destination host IDs and the location of source, as well as the pre-configured 5G multiple access signature (MA) and TSN multi-hop path, denoted as,
∀fi ∈ F, i ∈ {0, . . . , F − 1},
fi = {age, src, dst, loc, ma, path}. (1)
We consider non-buffer monitoring systems and the generate-atwill strategy is employed such that when fi decides to transmit at a certain subframe, it samples the packet at the beginning of that subframe and immediately sends this packet to the remote fi.dst. Since the freshest data is sampled, this strategy can largely decrease the age of system and the frequency of packet sampling and transmission for energy saving and low co-channel
Fig. 3. llustration of CTU in a time-frequency space.
interference. Then, the age evolution of gi,t at per-subframe granularity depends on whether a update packet is received within a subframe t, i.e., ri,t ∈ {0, 1}, and thus can be written as,
gi,t =
{ gi,t−1 + 1, if ri,t = 0,
1, if ri,t = 1, (2)
where gi,0 = 0. Note that the indicator value ri,t relies on both the sampling decision and successful transmission probability.
B. Grant-Free Multiple Configured-Grants NOMA in 5G
For massive low-latency uplink transmissions, GF-NOMA with multiple CGs is considered, where the BS pre-configures NCG CGs at each subframe t with the CG set defined as NCG. Then, the BS sends radio resource control or downlink control information to activate the static CG configuration [3], [20]. Each CG has the fixed parameter tuple as
∀CGp ∈ NCG, p ∈ {0, . . . , NCG − 1},
CGp = {NRB, Noffset, Nrepe}. (3)
 NRB denotes the number of resource blocks (RBs) in this CG.2Based on this time-frequency resource, the minimal resource that flows compete for is the contention transmission unit (CTU), which is represented by a RB and an MA signature, as shown in Fig. 3. If multiple flows transmit with the same CTU, the BS cannot differentiate and detect them, and thus cannot decode their packets.
 Noffset is the starting time slot of CG within a subframe.
 Nrepe is the number of repetitions.3 We assume Nrepe = 1 for problem simplification and this can be extended to the case with different number of repetitions for our future reliability-based work.
Definition 1 (Sampling-Transmission Scheduling Action): For any flow fi ∈ F, the scheduling action at subframe t is defined as the tuple φi,t := {κi,t, ci,t} ∈ Φ composed of the sampling decision κi,t ∈ {0, 1} and if κi,t = 1, the operating CTU ci,t ∈ NCT U , where NCT U contains the CTUs of all the CGs. Since the MA signature can be pre-defined for a flow, the action space Φ of a distributed flow can be reduced with the
cardinality of |Φ| = ∑
p CGp.NRB + 1.
At the beginning of each subframe, flows make scheduling actions, where fi generates a status update packet according to
2We focus on short status packet transmission. Therefore, every time a flow generates one status update packet and it can be delivered through a RB. 3The transmission reliability can be enhanced with a pre-defined number of consecutive replicas of the same packet in consecutive time slots.
Authorized licensed use limited to: GUANGZHOU UNIVERSITY. Downloaded on September 25,2024 at 03:00:57 UTC from IEEE Xplore. Restrictions apply.


LI et al.: DECAGE: DECENTRALIZED FLOW SCHEDULING FOR INDUSTRIAL 5G AND TSN INTEGRATED NETWORKS 547
κi,t and transmits it on ci,t with power P . Based on GF-NOMA, the BS, upon each time slot, finds the set of singletion CTUs (as shown in Fig. 3), where each CTU is chosen by only one flow with successful detection. Then, the BS performs the successive interference cancellation (SIC) technique to decode the packets of these flows. Based on NOMA principle, at each iterative SIC stage, the BS decodes the flow with the strongest received power and then subtracts the successfully decoded signal from the received signal [7]. The SIC procedure stops when one iterative stage fails. Thus, the decoding order is in sequence to the received power, and the signal-to-interference-plus-noise ratio (SINR) of a transmitting flow fi is derived as,
ζi,t = P × k[ci,t]
σ2 + ∑
j∈{Ci,t} P × k[cj,t] + ∑
m∈{C′i,t} P × k[cm,t] .
(4) Ci,t contains the detected flows that transmit on the same RB
with fi and are decoded in the SIC iterative stages behind fi. C′i,t denotes the flows with detection failure in this RB. We consider channel fading is independent across different RBs. During a time slot, the stochastic process of fi’s channel gain over a RB
(determined by ci,t), k[ci,t], is defined as αf
i kˆ[ci,t]. kˆ[ci,t] is the frequency dependent small-scale fading power component whereas αf
i denotes the frequency dependent large-scale fading effect, which consists of path loss and shadowing. For successful decoding, we set the SINR threshold as ζth.
C. CQF-Based Multi-Hop Forwarding in TSN
To reduce sojourn time, the packet of fi will be immediately injected into the TSN network and delivered to its destination once successfully received by the BS for seamless transmission. In the multi-hop TSN network, the latency, is predictable and deterministic, which only depends on the pre-configured time slot size and path length. Here, we set the slot size in TSN to be the same with that in 5G for slot alignment as 5G URLLC has shorter mini-slots for TSN integration. We formally abstract the TSN topology as a directed graph G = {V, E}, where V is a set of TSN switches and E denotes a set of edges connecting any two switches. For each flow fi, its path is described with consequent links as fi.path = (e1, . . . , ehopi ), where hopi is the hop length. Since the queue length is limited, CQF-based queues are prone to overflow without elaborated injection time planning. Hence, for a transmitting fi, the decisive factors of 5G+TSN end-to-end latency contain the time slot offset CGci,t .Noffset of the operating CTU ci,t and the hop length hopi. Formally, based on the TSN deterministic forwarding, the receiving time slot for every hop of fi can be calculated a priori based on the deduced delaying injection time as,
∀fi ∈ F, i ∈ {0, . . . , F − 1}, e ∈ fi.path
τslot (fi, e) = hop[e, fi] + CGci,t .Noffset + l5 G. (5)
l5 G is the fixed processing and propagation delay in 5G (at per-time slot granularity). hop[e, fi] indicates the hop number of
link e in fi.path. To avoid queue overflow and guarantee deterministic transmission, the following queue resource constraint of CQF-based TSN network should be satisfied. Queue resource constraint: This constraint restricts that the usage of each queue should not exceed the queue length limit Qsize. Formally, we define the mapping indicator mie,τ to denote whether fi occupies the queue resource block (e, τ ), which represents the transmission resource in the corresponding port of the upstream switch of link e ∈ E at time slot τ . Then, this constraint can be written as,
∀fi ∈ F, i ∈ {0, . . . , F − 1}, ∀e ∈ E, ∀τ,
qe,τ =
F −1
∑
i=0
mi
e,τ ≤ Qsize, (6)
where qe,τ indicates the queue length at time slot τ of link e.
D. Problem Formulation
1) Primal and Dual AgeDS Problem: Now we can formulate the cooperative optimization problem, that is the age-aware flow deterministic scheduling (AgeDS) problem in 5G+TSN integrated networks, given as,
J : mφitn
∑
i
κi,tPst
s.t. E[gi,t(κt, ct)] ≤ fi.age, ∀i,
E[qe,τ (κt, ct)] ≤ Qsize, ∀e, ∀τ ∈ t. (7)
Pst denotes the total sampling-transmission energy consumption. Besides the sampling decision vector κt of all flows, their transmission decision vector ct along with the corresponding delaying injection times, would affect whether packets will be received at the destinations (i.e., ri,t) as well as the age and queue evolution. Thus, we describe these evolution processes as age and queue functions (i.e., gi,t(κt, ct) and qe,τ (κt, ct)) with the expectation E[·] denotes that they evolve with respect to the stochastic processes of channel gain and communication interference. This makes AgeDS a stochastic and constrained problem with environment uncertainty. Therefore, we opt for dual optimization in an ergodic manner by introducing dual variables λ, which are corresponding to the ergodic long-term average age and queue states (the time index t is dropped based on ergodicity). Formally, the Lagrangian dual problem is deduced as,
D : mλax mφin E
[∑
i
κiPst + ∑
i
λi(gi(κ, c) − fi.age)
+∑
e
∑
τ
λe,τ (qe,τ (κ, c) − Qsize)
]
s.t. λ ≥ 0.
we denote the process inside the expectation notation as the dual function L(φ, λ), concisely. 2) Duality Gap Analysis: Note that the AgeDS problem is non-convex and thus there exists duality gap (i.e., J∗ ≥ D∗). Despite the lack of concavity, the following theorem shows that
Authorized licensed use limited to: GUANGZHOU UNIVERSITY. Downloaded on September 25,2024 at 03:00:57 UTC from IEEE Xplore. Restrictions apply.


548 IEEE TRANSACTIONS ON NETWORK SCIENCE AND ENGINEERING, VOL. 11, NO. 1, JANUARY/FEBRUARY 2024
the stochastic AgeDS problem has null duality gap under mild conditions permitting their solution in the dual domain. Theorem 1: Let J∗ denote the optimum value of the primal AgeDS problem and D∗ that of its dual. Assume there exists a strictly feasible point φ0 that satisfies both age and queue resource constraints with strict inequality. If the channel probability distribution k does not contain the point of positive probability, the duality gap is null, i.e., J∗ = D∗. Proof: According to the Theorem 1 in [21], when satisfying the requirements of constraint qualification and nonatomic measure of channel distribution, the ergodic limit span, containing all the possible values that the expectation of gi,t(κt, ct) and qe,τ (κt, ct) can take, is convex based on Lyapunov’s convexity theorem. The condition on channel distribution not having points of positive probability (i.e., nonatomic measure), is a mild requirement satisfied by practical fading channel models including Rayleigh, Rice, and Nakagami. The detail can be seen in the proof of Theorem 1 in [21], which is not discussed here for the sake of space.
E. Primal-Dual Stochastic Gradient Descent
Having null duality gap means that AgeDS can work in dual domain without loss of optimality. Hence, we adopt the stochastic gradient descent method [21] to update both primal and dual variables in an iterative manner as in (8)–(10) by re-introducing the time index t and stepsizes αt and βt. Since the dual function is convex concerning dual variables, we update λ using the zeroth-order representation g ̃i,t, q ̃e,t. The latter q ̃e,t is the number of packet overflows in TSN within a subframe, which is counted to update the reduced dual variables for each queue of link e rather than (e, τ ).
φt+1 = ΠΦ{φt − αt∇φt E[L(φ, λ)]}, (8)
λi,t = [λi,t + βtg ̃i,t]+ , where g ̃i,t = gi,t − fi.age, ∀i, (9)
λe,t = [λe,t + βtq ̃e,t]+ , where q ̃e,t = ∑
τ ∈t
(qe,τ − Qsize) ∀e.
(10)
Based on supermartingale argument, if the stepsizes βt form a
nonsummable but square summable series, i.e., ∑∞
t=0 βt = ∞
and ∑∞
t=0 βt2 < ∞, it can be shown that λi,t, λe,t converge to the optimum almost surely [21]. Hence, the left issue is how to solve (8) with respect to φ in the decentralized setting under uncertain and non-stationary environment.
IV. DECAGE: AGE-AWARE SCHEDULING ORCHESTRATOR BASED ON MULTI-AGENT RL (MARL)
The straightforward evaluation of (8) is intractable for individual flows since neither the dual function nor its gradients are explicitly known a priori due to stochastic channel gain and time-varying scheduling policies of concurrently-exploring teammates. To address this issue, the model-free MARL algorithm is a potential approach to be considered.
A. Preliminaries: Actor-Critic RL on the CTDE Paradigm
Recall that DecAge deals with the non-stationary learning issue based on the centralized training with decentralized execution (CTDE) paradigm. To elaborate, there are F local learning agents for each flow fi, i.e., Flowactor i, to learn its scheduling policy πi and update the corresponding age dual variable λi,t. Using the near-universal deep neural network (DNN) parametrization4 with parameter θi, the scheduling policy, also referred to as πi〈θi〉 or πi〈oi|θi〉, takes the local observation oi,t = (g ̃i,t−1, λi,t−1, fi.age, fi.loc, fi.ma) and generates the sampling-transmission action φi,t at each t. Flowactor i updates πi〈θi〉 via trial-and-error learning samples to optimize the ergodic long-term dual function. Formally, based on DNN parametrization and policy gradient theorem [22], the optimization of primal update is performed over θ rather than the policy directly as follows,
θi,t+1 = ΠΘ {θi,t − αt∇θi E[L(φ, λ)]} ,
ΠΘ {θi,t − αtE[Q(st, at)∇θi log πi〈θi〉]} , (11)
where Q(st, at) is the estimation value of ergodic long-term dual function at each t learned by Edgecritic. In the non-stationary environment, an learning agent’s transition probabilities may change as other learning agents update their policies. Therefore, the central Edgecritic based on CTDE paradigm is proposed in the edge-assisted BS to learn the dual function from a global and long-term view. Moreover, the BS can also facilitate to infer the packet overflow possibility based on the deterministic forwarding property of TSN. Specifically, with all the information collected from Flowactors off-line, Edgecritic generates the following three-tuple: 1) State: the global state defined as st = (o1,t, . . . , oF,t). 2) Action: the joint action defined as at = (φ1,t, . . . , φF,t). 3) Cost: the instantaneous dual value, denoted as Lt =
∑
i(κiPst + λig ̃i,t) + ∑
e λe,tq ̃e,t.
Based on this three-tuple at each subframe, Edgecritic estimates the action-state function, a.k.a. Q network, based on the deep Q network (DQN) algorithm [23],
Q(st, at) = E
[∑
t
γt−t0 Lt|s0, a0
]
.
This DNN-based Q(st, at) denotes the long-term accumulated dual values with discount factor γ. Then, the DNN parameters of Q(st, at) are updated using the temporal-difference error with the learning rate ηt, given as,
Losst = E [Q(st, at) − (Lt + γQ′(st+1, π′〈st+1|θt〉))] ,
(12) where the skills of off-policy learning is utilized to improve training stability. Specifically, Q′(·) and π′〈·〉 denote the target Q network and scheduling policies, which are updated using the soft target update [23] to slowly track their estimated networks, i.e., Q(·) and πi〈·〉.
4Policy parameterization will bring some duality gap due to the function approximation error. However, the duality gap could be very small when using near-universal parameterizations, e.g., DNN [22].
Authorized licensed use limited to: GUANGZHOU UNIVERSITY. Downloaded on September 25,2024 at 03:00:57 UTC from IEEE Xplore. Restrictions apply.


LI et al.: DECAGE: DECENTRALIZED FLOW SCHEDULING FOR INDUSTRIAL 5G AND TSN INTEGRATED NETWORKS 549
Fig. 4. Framework of DecAge, which contains multiple local Flowactors and a central Edgecritic.
B. Edgecritic With Augmented Adjacency Graph-Based GAT
The overall architecture of Edgecritic can be seen in Fig. 4. According to the individual-global-min property [24] of AgeDS problem5, the Q network is decomposable, which is the sum of individual Q network of each flow as,
Qi(st, at)
=E
⎡
⎣∑
t
γt−t0 (κi,tPst + λi,tg ̃i,t + ∑
e∈fi .path
λe,t1o
e,t)
⎤
⎦,
where 1eo,t is the indicator denoting whether the packet overflow of fi happens in the link e of its fi.path. Therefore, the objective of Edgecritic is to learn Qi(st, at) for each Flowactor. As the operation is done at each subframe, the index t is dropped in the next for ease of notation.
Augmented adjacency graph-based GAT: For the graphstructured flows, Qi(s, a) is learned by GAT [25], which can be represented by a function fˆ of fi’s feature hi(oi, φi), and the contributions of others [26], formulated as,
Qi(s, a) = fˆ(hi(oi, φi), h−i) .
where hi(·) is for feature reconstruction, which contains learnable linear transformation, e.g, multi-layer perceptron (MLP), and embedding layers for discrete encoding. To capture the impact of others, an augmented adjacency graph (AAG) is proposed. For collision-free transmission, the adjacent flows of fi in AAG are defined as the flows with the potential to interfere its packet delivery, i.e., with the same MA or within a certain distance (Sth), or having overlapping TSN paths. Formally, the adjacent flow set is defined as,
Si = {fj ∈ F \ fi | (fi.ma = fj.ma)
∪ (‖fi.loc − fj.loc‖ ≤ Sth)
∪ (fi.path ∩ fj.path = ∅)}. (13)
5arg minaQ∗(s, a) = (arg minφ1 Q1(o1, φ1) . . . arg minφNQN(oN , φN))
Based on the features of adjacent flows, h−i can be calculated by the linear combination of them (after potentially applying a nonlinearity, σ[·]), formulated as
h−i = σ
⎡
⎣∑
fj ∈Si
ωi,j hj (oj , φj )
⎤
⎦,
where ωi,j is the attention factor representing the impact degree of j to i. It is learned by a shared attention mechanism, which compares the feature hi with hj using the bilinear query-key mapping system,
ωi,j = softmax[hT
j WT
k Wqhi],
where Wq transforms hi into a query and Wk transforms hj into a key and softmax[·] is the normalized exponential function across all choices of j. To stabilize learning process, multi-head attention is used, where Z independent attention mechanisms are learned and the corresponding features are concatenated (i.e., ‖) to serve as the final output feature for every flow, as
h−i = ‖Z
z=1σ
⎡
⎣∑
fj ∈Si
ωz
i,j hj (oj , φj )
⎤
⎦.
Then, h−i, hi are fed into a two-layer MLP to output Qi(s, a). Variance-reducing baselines: To further reduce the variance of gradient estimation for individual Flowactor, an actiondependent advantage function Ai(s, a) is calculated [27] based on Q network. Specifically, a bias-free baseline is introduced, that only marginalizes out the action φi of the given Flowactor from Qi(s, a) with all other Flowactors fixed, as
Ai(s, a) = Qi(s, a) − b(s, a−i), where
b(s, a−i) = Eφi∼πi〈oi|θi〉
[Qi(s, (φi, φ−i))] . (14)
Ai(s, a) indicates whether the specific action of Flowactor i will cause an increase in dual value cost or whether any increase in cost is attributed to the actions of other flows. Therefore, this
Authorized licensed use limited to: GUANGZHOU UNIVERSITY. Downloaded on September 25,2024 at 03:00:57 UTC from IEEE Xplore. Restrictions apply.


550 IEEE TRANSACTIONS ON NETWORK SCIENCE AND ENGINEERING, VOL. 11, NO. 1, JANUARY/FEBRUARY 2024
Algorithm 1: The Workflow of DecAge Scheme.
baseline can largely reduce the policy estimation variance and assists Flowactor speeding up policy convergence.
C. Flowactor With Hierarchical Hysteretic Learning
AAG-assisted hierarchical scheduling policy: Recall that local Flowactors train scheduling policies based on the customized advantage function Ai(s, a) from Edgecritic, however, with the local observation oi,t. To facilitate coordination, we propose to let each Flowactor consider the state prediction oˆ−i of only its adjacent flows in AAG for decision-making,
φi ∼ πi〈oi, oˆ−i〉, where oˆ−i = {oj }fj∈Si ,
where oˆ−i can be easily inferred by GAT-based Edgecritic with global information. This neighboring-based message can make Flowactor sensitive to the transmission collision threat from the adjacent flows in Si during both training and inference phases. As a result, optimal scheduling policies would like to choose collision-free CTUs or even be idle when adjacent flows are
likely to transmit. Hence, flows transmit episodically to reduce power consumption and interference to others since there is no need to update if status is fresh enough. This leads to learning with sparse communication rewards due to the hierarchy of scheduling action. To address this issue, we present the hierarchical hysteretic learning with an auxiliary subgoal in each Flowactor. Specifically, Flowactor has a hierarchically-structured policy, allowing for control concurrently at two-levels. Formally, the joint policy is composed of an age-aware high-level sampling policy πiκ and
the communication-oriented low-level skill πic. The high-level action is defined as the sampling decision
κi ∼ πκ
i 〈oi, oˆ−i〉,
which refers to the inclination to deliver a packet. At each subframe, πiκ passes this instruction to the lower-level skill
πic, which serves as the subgoal of whether or not having a
collision-free packet delivery. Therefore, the aim of πic is to only transmit successfully, which is conditioned on κi that alters states in a consistent way as,
ci ∼ πc
i 〈κi, oi, oˆ−i〉.
In this way, lower-level skills are supervised with subgoals that are proposed automatically by higher-level policies. In Flowactor, πiκ and πic partially share the parameters θi in the previous MLP layers for feature transformation, followed by the hierarchical MLPs for the corresponding πiκ and πic. The detailed architecture is delineated in Fig. 4. The high-level policy πiκ is trained from the global prospect with the feedback advantage function as,
θi,t+1 = ΠΘ{θi,t − αtAi(st, at)∇θi log πκ
i 〈θi,t〉}. (15)
Moreover, we design an intrinsic reward, which reflects the realistic transmission result for low-level training, defined as,
Ri,t = ψκi,t(2ri,t − 1), (16)
which punishes the low-level skill with −ψ when collision happens and promotes it for successful packet delivery. As a result, the task of finding the collision-free CTUs is decoupled, which forms a communication game of transmitting flows. Hysteretic learning: With the insight that low returns in this game may be caused by domain stochasticity. In other words, the transmission failure of a flow may be mainly caused by others’ exploratory actions [28]. To lag the degradation of the policy underestimated due to the outcomes unrelated to its associated action, hysteretic learning is utilized. Formally, two learning rates are defined, where a nominal learning rate, αp, is used when the reward Ri,t is non-negative and a smaller learning rate, αn is used otherwise (where 0 < αn < αp < 1). In this way, more attention will be paid to the positive learning samples (a.k.a. experiences) that occurred due to the successful cooperation among transmitting flows.
Authorized licensed use limited to: GUANGZHOU UNIVERSITY. Downloaded on September 25,2024 at 03:00:57 UTC from IEEE Xplore. Restrictions apply.


LI et al.: DECAGE: DECENTRALIZED FLOW SCHEDULING FOR INDUSTRIAL 5G AND TSN INTEGRATED NETWORKS 551
D. Workflow of DecAge With Flow Re-Injection for TSN
The workflow of both Flowactors and Edgecritic can be concluded in Algorithm 1 and Fig. 4. 1) Local Flowactor: Flowactor aims to learn an age-aware hierarchical scheduling policy for each flow. To be specific, at the beginning of each subframe t, Flowactor firstly gets the observation oi,t, oˆ−i,t to make sampling and transmission decisions on-site through the hierarchical policy πiκ, πic. Then, all flows perform their scheduling actions and have age evolution accordingly. After that, each flow updates its age dual parameter λi,t locally. After receiving the advantage function Ait from Edgecritic, Flowactor gets a sample {oi,t, oˆ−i,t, Ait} and its primal parameters of hierarchical scheduling policy will be updated once collecting a batch of samples (with batch size M a). Note that this training is done in an off-line manner and thus does not need timely feedbacks from Edgecritic. 2) Central Edgecritic: Edgecritic, located at the edge controller, aims to estimate the performance of Flowactors from a global and long-term view. During each subframe t, Edgecritic collects local observations from Flowactors along with the action probability distribution pφi for bias-free baseline calculation. Based on consecutive local observations information, Edgecritic forms an experience eˆt. With experience replay skill, Edgecritic accumulates a dataset of experiences and randomly gets a minibatch {eˆm}m∈{1...Mc} experiences with size M c to train Q network via DQN. Finally, Edgecritic outputs Ait, oˆ−i,t+1 to each Flowactor for local training and inference. Flow re-injection: Besides the policy estimation, Edgecritic keeps computing the queue length of CQF-based queues virtually during a subframe based on the deterministic forwarding property for collision-avoiding. With virtual queues, Edgecritic re-injects the packet received in the BS that has been foreseen to overflow according to the offset of its transmitting CG. Specifically, Edgecritic incrementally increases the injection time offset of this packet until it is deduced to be delivered successfully. This step can guarantee the deterministic delivery in TSN at the sacrifice of having additional waiting time in the BS. In this way, the real dual value Li,t doesn’t contain the punishment of overflow and thus Edgecritic modifies Li,t, si,t+1 with the inference of q ̃e,t (with packet loss) considered, written as Lˆ i,t, sˆt+1 in the experience eˆ.
Complexity and scalability analysis: Note that the training phase can be done in an off-line manner in Flowactors and Edgecritic, where the most computational tasks (i.e., policy estimation) are offloaded to Edgecritic with powerful computing ability. As for real-time scheduling action inference in local Flowactors, the time complexity of DNN-based scheduling policy linearly scales with the number of DNN parameters (depending on the number of layers as well as the sizes of input and output) and the cardinality of action space (i.e.,
|Φ| = ∑
p CGp.NRB + 1) [29]. Therefore, compared with the centralized scheduling having a joint action space (with the cardinality |Φ|F ), the time complexity of DecAge largely decreases from exponential with |Φ| to linear with |Φ|. Moreover, DecAge is scalable and can react to any change of flow number by adding or removing the Flowactor in the corresponding flow host. Then, the scheduling policies in Flowactors
TABLE III SIMULATION PARAMETERS
are re-trained using real-time cost feedback. Moreover, the central GAT-based Edgecritic is based on inductive learning, which can apply to completely unseen graphs since only the neighbors’ features are utilized and the operation of GAT is parallelizable across node neighbor pairs.
V. PERFORMANCE EVALUATION
In this section, we demonstrate the effectiveness of DecAge under different settings of 5G+TSN integrated networks.
A. Experimental Setups
The parameters of 5G+TSN networks are listed in Table III, which partially follow the works [20], [30], [31]. d represents the distance between transmitters and receivers.
Setting for 5G NR and flow feature: We focus on the 5G system with mini-slots of 7 OFDM symbols using Δf = 60 kHz (μ = 2) in line with the main guidelines for 3GPP NR performance evaluations in [30]. For age-aware monitoring tasks, 50 flow hosts are randomly positioned inside a 600×600 m2 industrial service area with their remote destinations randomly selected from the TSN switch set. Their QoS requirements, i.e., age limits, are set from [4,8]ms, which follow the deadline request of industrial applications (e.g.,1ms-20 ms for factory automation) [2]. The BS is located in the center of this area, responsible for SIC decoding and packet injection. All devices operate based on the WINNER II indoor model, a link-level channel model for LTE system design [31]. In the non-line of sight (NLOS) path loss model, Nwall denotes the number of walls between two locations and is set to d/50. For successful SIC decoding, the SINR threshold ζth is set to be 0 dB.
Setting for CQF-based TSN: A TSN network with mesh topology is established, which contains 16 TSN switches and a TSN gateway in the BS. Every two switches are connected with probability 0.2. We only consider unicast flows with single source and destination as multicast flows can be split into multiple unicast flows. Their TSN paths are per-configured according to the shortest forwarding paths computed by Dijkstra [32] with maximal hop count 7. Based on the network scale, the length of each CQF-based queue is set to 3. Actually, the queue length should be small enough to avoid long time packet cache [15]. The more realistic network parameters, e.g., link bandwidth, global
Authorized licensed use limited to: GUANGZHOU UNIVERSITY. Downloaded on September 25,2024 at 03:00:57 UTC from IEEE Xplore. Restrictions apply.


552 IEEE TRANSACTIONS ON NETWORK SCIENCE AND ENGINEERING, VOL. 11, NO. 1, JANUARY/FEBRUARY 2024
time slot size, will be further considered in our future work of building a real 5G+TSN integrated platform for verification. Hyperparameters: In DecAge, both Flowactors and Edgecritic are trained with the Adam optimizer. The local scheduling policy contains 2-layer MLP with hidden size 128. The Q network in Edgecritic is composed of an MLP with hidden size 128 for feature reconstruction, an multi-head attention based GAT network with Z = 3 as well as the output feature size 32, and a 2-MLP output layer with hidden size 64. For Edgecritic, the learning rate is set to 0.001, while for Flowactors, the hierarchical hysteretic learning is applied with αp set to 0.008 for high-level training and αp, αn set to 0.001, 0.0001 for low-level training, respectively. As for AAG, the neighbors of fi, i.e., Si, is defined as the flows 1) within the distance of 200 m or the same MA, and 2) with overlapping paths in TSN.
B. Simulation Results
The following metrics are considered: 1) age violation ratio (VR), the percentage of flows whose age constraints are violated; 2) power efficiency (EFF), which is calculated as the ratio of the total power consumption to the number of flows satisfying age constraints, i.e.,
Power EFF =
∑
i κi,tPst
∑
i 1{gi,t ≤ fi.age} ;
3) communication efficiency, the packet loss ratio of 5G+TSN transmission; and 4) learning capability, that includes the cost prediction error and the MSE (mean squared error) loss of Edgecritic (γ = 0). Note that the age VR metric relies on both sampling and transmission decisions, and thus it is relevant to the metrics of power and communication efficiency.
1) Comparison of Different Scheduling Policies: We first compare the proposed DecAge with the following schemes,
 SRandom [7], where flows access the nearest CGs and randomly choose the CTUs if needed, i.e., gi,t − fi.age = 0;
 Dec-PG [22], where the hierarchical scheduling policy is learned locally by primal-dual policy gradient with the individual and instantaneous cost κiPst + λi(gi,t − fi.age). Fig. 5 delineates the performance of three scheduling policies. It can be clearly seen that DecAge significantly outperforms the traditional strategy SRandom in terms of all the metrics since it can guide flows intelligently to choose collision-free CTUs through learning. Compared with the Dec-PG scheme, the scheduling policies trained by DecAge converge faster with the CTDE learning framework as well as the action-dependent baseline in terms of variance reduction. Moreover, it can be observed in the subfigures that DecAge achieves lower age violation ratio (close to 0) and better communication efficiency after policy convergence, leading to better power efficiency. Thus, flows orchestrated by DecAge can timely deliver status packets with less power consumption in 5G+TSN networks.
2) Performance of Hierarchical RL of DecAge: The performance improvement of DecAge with hierarchical learning is shown in Fig. 6, where DecAge-w/oH denotes the policies without hierarchical DNN for action output layers (with the output dimension |Φ|). Obviously, DecAge without HRL experiences
Fig. 5. Performance comparison of scheduling policies.
Fig. 6. Performance of hierarchical RL of DecAge.
a long-time performance vibration before policy convergence since most flows will transmit regardless of their age states due to the mixed structure of action output layers. As a result, it takes Flowactors longer time to find the right sampling time and the power consumption of DecAge-w/oH is much higher at first 1000 time slots. Nevertheless, DecAge-w/oH keeps searching for the way of collision-free transmission based on the curve of communication efficiency. Hence, the policies of DecAge-w/oH will finally converge.
3) Performance of DecAge and Its Action-Dependent Baseline Under Different Environments: DecAge is evaluated in Fig. 7 under different environments with various numbers of flows and wireless resources (i.e., CG, RB and MA). Moreover, DecAge-w/oB adopting the CDTE learning with traditional action-agnostic baselines is also compared. Note that, more flows need to update their status packets at each subframe with the increasing number of flows and thus transmission collision probability increases, which leads to larger age violation ratio and power consumption. Nevertheless, the elaborately-designed
Authorized licensed use limited to: GUANGZHOU UNIVERSITY. Downloaded on September 25,2024 at 03:00:57 UTC from IEEE Xplore. Restrictions apply.


LI et al.: DECAGE: DECENTRALIZED FLOW SCHEDULING FOR INDUSTRIAL 5G AND TSN INTEGRATED NETWORKS 553
Fig. 7. Performance of DecAge and DecAge without action-aware baseline (DecAge-w/oB) in different environments.
Fig. 8. Ablation study of DecAge.
baselines along with the information of neighbors assist Flowactors perceiving the contributions of others when collision happens and trying to find out collision-free CTUs at the next time with similar situation. Thus, the performance of DecAge will not deteriorate as that of DecAge-w/oB in the environment with large number of flows (e.g., 80) in Fig. 7(a). Another observation can be seen is that with the same resource density (i.e., 16/80 = 10/50), the performance of DecAge in (80, 8 × 2) in Fig. 7(a) is worse than that in (50, 5 × 2) in Fig. 7(b). This is because, with fewer CGs, more packet overflows happen in the CQF-based queues due to the lack of time offset. For the same reason, the less impact of MA number on performance is shown in Fig. 7(c) since flows can form suitable collision-free communication coalitions under the guidance of DecAge even in the shortage of resources.
4) Ablation Study of DecAge: The ablation study is conducted as shown in Fig. 8, where the performances of DecAge as well as the DecAge without hysteretic learning (w/o Hy), without adjacent flow state prediction (w/o adj), and without both (w/o Hy-adj) are delineated. It can be clearly seen that DecAge without both skills cannot guide flows to find suitable scheduling policies to meet their age constraints. To analyze separately, the policies learned by w/o Hy will converge despite taking more time since the actions with high costs are over-punished in the
Fig. 9. Approximation performance of the critic.
previous exploratory phase. Moreover, although w/o adj can achieve fast policy convergence, the curves of w/o adj fluctuate severely. This is because, without taking their information into account, flows cannot completely give way to the adjacent flows having collision threat.
5) Approximation Performance of the Critic: To test the learning ability of Edgecritic, we conduct the prediction task of instantaneous costs (γ = 0) under the Flowactors following DecAge and SRandom, respectively. Critic-MLP denotes the Edgecritic with the Q network composed of MLP while CriticGAT is the one DecAge adopts. Fig. 9 shows the prediction error (per flow) and MSE loss. As policy converges, the prediction error decreases quickly in both Critic-MLP and Critic-GAT with the policy learned by Flowactor. Nevertheless, Critic-GAT achieves better prediction accuracy, which is much obvious under the situation of SRandom. It’s important to have satisfactory performance in SRandom situation since the calculation of action-dependent baseline needs more possibilities taken into considered. Therefore, Critic-GAT can mitigate the over-fitting issue by the mechanisms of graph and attention.
VI. RELATED WORK
The third generation partnership project (3GPP) has introduced enhanced GF transmission in 5G uplinks with multiple active CGs. In addition, NOMA has been proposed to synergize with GF transmission to mitigate the serious transmission delay and network congestion problems.
Authorized licensed use limited to: GUANGZHOU UNIVERSITY. Downloaded on September 25,2024 at 03:00:57 UTC from IEEE Xplore. Restrictions apply.


554 IEEE TRANSACTIONS ON NETWORK SCIENCE AND ENGINEERING, VOL. 11, NO. 1, JANUARY/FEBRUARY 2024
In the traditional GF-NOMA schemes, URLLC users simply select the nearest CGs to transmit packets. Therefore, from the BS’ perspective, the authors in [7], [8] introduced DRL to optimize the CG configuration parameters, e.g., the number of CTUs and the time offset of CGs, to balance the allocation of channel resources among CGs in order to maximize the number of successful transmissions. Form the perspective of users, a DRL-based GF-NOMA algorithm is proposed to learn about the network contention state, and output subchannel and received power level selection to reduce transmission collisions in the frequency domain [9]. Similarly, the authors in [10] proposed distributed Q-learning aided uplink GF-NOMA schemes with bursty traffic considered to maximize the number of accessible devices. Although these DRL-based GF-NOMA resource allocation schemes have been proposed to optimize network collision and have reduced computational complexity with distributed learning. Nevertheless, the unstable learning issue brought by non-stationary environment and partial observability of local users is not well-addressed. Therefore, we propose DecAage to deal with this issue using centralized training with decentralized execution paradigm in multi-agent RL.
VII. CONCLUSION
This article addresses the age-aware flow scheduling problem in 5G+TSN integrated networks, where DecAge, a decentralized scheduling scheme based on multi-agent RL, is proposed to guide flows to make sampling-transmission actions. To elaborate, DecAge contains multiple Flowactors for local flows to learn distributed scheduling policies and a central Edgecritic to coordinate the behaviors of flows based on the GAT-based Q network and variance-reducing baselines. Edgecritic is scalable to the number of flows despite centralized training and assists flows to differentiate the impact of others, leading to fast policy convergence. Moreover, faced with insufficient communication samples, Flowactor is extremely sample-efficient with adjacent state aware hierarchical learning, which decouples sampling and transmission actions by the hierarchically-structured DNN. And hysteretic learning is introduced, which lags the degradation of transmission actions that was underestimated due to the outcomes related to others’ exploration. In general, the robustness of Flowactors to non-stationarity and the scalability of Edgecritic make DecAge well-suited to the distributed and partial-observed systems and also provides a potential solution for future studies on the scheduling of graphstructured wireless networks.
REFERENCES
[1] A. Nasrallah et al., “Ultra-low latency (ULL) networks: The IEEE TSN and IETF DetNet standards and related 5G ULL research,” IEEE Commun. Surveys Tut., vol. 21, no. 1, pp. 88–145, First Quarter 2019. [2] A. Mahmood et al., “Industrial IoT in 5G-and-beyond networks: Vision, architecture, and design trends,” IEEE Trans Ind. Informat., vol. 18, no. 6, pp. 4122–4137, Jun. 2022. [3] M. B. Shahab, R. Abbas, M. Shirvanimoghaddam, and S. J. Johnson, “Grant-free non-orthogonal multiple access for IoT: A survey,” IEEE Commun. Surveys Tut., vol. 22, no. 3, pp. 1805–1838, Third quarter 2020.
[4] Y. Liu, Y. Deng, M. Elkashlan, A. Nallanathan, and G. K. Karagiannidis, “Analyzing grant-free access for URLLC service,” IEEE J. Sel. Areas Commun., vol. 39, no. 3, pp. 741–755, Mar. 2021. [5] R. Abbas, M. Shirvanimoghaddam, Y. Li, and B. Vucetic, “A novel analytical framework for massive grant-free NOMA,” IEEE Trans. Commun., vol. 67, no. 3, pp. 2436–2449, Mar. 2019. [6] Z. Ding, R. Schober, P. Fan, and H. V. Poor, “Simple semi-grant-free transmission strategies assisted by non-orthogonal multiple access,” IEEE Trans. Commun., vol. 67, no. 6, pp. 4464–4478, Jun. 2019. [7] Y. Liu, Y. Deng, M. Elkashlan, A. Nallanathan, and G. K. Karagiannidis, “Optimization of grant-free NOMA with multiple configured-grants for mURLLC,” IEEE J. Sel. Areas Commun., vol. 40, no. 4, pp. 1222–1236, Apr. 2022. [8] Y. Liu, Y. Deng, H. Zhou, M. Elkashlan, and A. Nallanathan, “Deep reinforcement learning-based grant-free NOMA optimization for mURLLC,” IEEE Trans. Commun., vol. 72, no. 3, pp. 1475–1490, Mar. 2023. [9] J. Zhang, X. Tao, H. Wu, N. Zhang, and X. Zhang, “Deep reinforcement learning for throughput improvement of the uplink grant-free NOMA system,” IEEE Internet Things J., vol. 7, no. 7, pp. 6369–6379, Jul. 2020. [10] J. Liu, Z. Shi, S. Zhang, and N. Kato, “Distributed Q-learning aided uplink grant-free NOMA for massive machine-type communications,” IEEE J. Sel. Areas Commun., vol. 39, no. 7, pp. 2029–2041, Jul. 2021.
[11] IEEE Standard for Local and Metropolitan Area Networks–Bridges and Bridged Networks - Amendment 25: Enhancements for Scheduled Traffic, IEEE Std.802.1Qbv-2015, 2016. [12] D. Yang, K. Gong, J. Ren, W. Zhang, W. Wu, and H. Zhang, “TCFlow: Chain flow scheduling for advanced industrial applications in timesensitive networks,” IEEE Netw., vol. 36, no. 2, pp. 16–24, Mar./Apr. 2022. [13] IEEE Standard for Local and Metropolitan Area Networks–Bridges and Bridged Networks – Amendment 29: Cyclic Queuing and Forwarding, IEEE Std. 802.1Qch-2017, 2017. [14] A. Nasrallah, V. Balasubramanian, A. Thyagaturu, M. Reisslein, and H. ElBakoury, “Cyclic queuing and forwarding for large scale deterministic networks: A survey,” 2019, arXiv:1905.08478. [15] J. Yan, W. Quan, X. Jiang, and Z. Sun, “Injection time planning: Making CQF practical in time-sensitive networking,” in Proc. IEEE Conf. Comput. Commun., 2020, pp. 616–625. [16] Y. Zhang, Q. Xu, L. Xu, C. Chen, and X. Guan, “Efficient flow scheduling for industrial time-sensitive networking: A divisibility theory based method,” IEEE Trans Ind. Informat., vol. 18, no. 12, pp. 9312–9323, Dec. 2022. [17] W. Quan, J. Yan, X. Jiang, and Z. Sun, “On-line traffic scheduling optimization in IEEE 802.1Qch based time-sensitive networks,” in Proc. IEEE 22nd Int. Conf. High Perform. Comput. Commun., IEEE 18th Int. Conf.Smart City, IEEE 6th Int. Conf. Data Sci. Syst., 2020, pp. 369–376. [18] D. Yang, Z. Cheng, W. Zhang, H. Zhang, and X. Shen, “Burst-aware time-triggered flow scheduling with enhanced multi-CQF in time-sensitive networks,” IEEE/ACM Trans. Netw., vol. 31, no. 6, pp. 2809–2824, Dec. 2023. [19] I. Kadota and E. Modiano, “Age of information in random access networks with stochastic arrivals,” in Proc. IEEE Conf. Comput. Commun., 2021, pp. 1–10. [20] 3rd Generation Partnership Project (3GPP), “Study on physical layer enhancements for NR ultra-reliable and low latency case (URLLC),” 3GPP, Sophia Antipolis, France, Tech. Rep. 38.824 v16.0.0, Mar. 2019. [21] A. Ribeiro, “Optimal resource allocation in wireless communication and networking,” Eurasip J. Wireless Commun. Netw., vol. 2012, no. 1/19, 2012, Art. no. 272. [22] M. Eisen, C. Zhang, L. F. O. Chamon, D. D. Lee, and A. Ribeiro, “Learning optimal resource allocations in wireless systems,” IEEE Trans. Signal Process., vol. 67, no. 10, pp. 2775–2790, May 2019. [23] T. P. Lillicrap et al., “Continuous control with deep reinforcement,” in Proc. Int. Conf. Learn. Representations, 2018, pp. 1–14.
[24] Y. Yang et al., “Qatten: A general framework for cooperative multiagent reinforcement learning,” 2020, arXiv:2002.03939. [25] P. Veliˇckovi ́c, G. Cucurull, A. Casanova, A. Romero, P. Liò, and Y. Bengio, “Graph attention networks,” in Proc. Int. Conf. Learn. Representations, 2018, pp. 1–13. [26] S. Iqbal and F. Sha, “Actor-attention-critic for multi-agent reinforcement learning,” in Proc. Int. Conf. Mach. Learn., 2019, pp. 2961–2970. [27] J. N. Foerster, G. Farquhar, T. Afouras, N. Nardelli, and S. Whiteson, “Counterfactual multi-agent policy gradients,” in Proc. AAAI Conf. Artif. Intell., 2018, pp. 2974–2982. [28] S. Omidshafiei et al., “Deep decentralized multi-task multi-agent reinforcement learning under partial observability,” in Proc. Int. Conf. Mach. Learn., 2017, pp. 2681–2690.
Authorized licensed use limited to: GUANGZHOU UNIVERSITY. Downloaded on September 25,2024 at 03:00:57 UTC from IEEE Xplore. Restrictions apply.


LI et al.: DECAGE: DECENTRALIZED FLOW SCHEDULING FOR INDUSTRIAL 5G AND TSN INTEGRATED NETWORKS 555
[29] Y. LeCun, Y. Bengio, and G. Hinton, “Deep learning,” Nature, vol. 521, pp. 436–444, 2015. [30] 3rd Generation Partnership Project (3GPP),“Study on new radio access technology-physical layer aspects,” 3GPP, Sophia Antipolis, France, Tech. Rep. 38.802 v14.0.0, Mar. 2017. [31] “WINNER II path loss model,” Accessed: Jan. 6, 2012. [Online]. Available: http://www.raymaps.com/index.php/winner-ii-path-loss-model/ [32] E. W. Dijkstra et al., “A note on two problems in connexion with graphs,” Numerische Mathematik, vol. 1, no. 1, pp. 269–271, 1959.
Mingyan Li received the B. E. degree in telecommunication engineering from Jinlin University, Changchun, China, in 2015, and the Ph.D. degree from the Department of Electronic Engineering, School of Electronic Information and Electrical Engineering, Shanghai Jiao Tong University, Shanghai, China, in 2021. In 2021, she joined the College of Computer Science, Chongqing University, Chongqing, China, where she is currently a Postdoctoral Research Associate. During 2019–2020, she was a Visiting Professor with the University of Waterloo, Waterloo, ON, Canada. Her research interests include industrial internet, the next generation mobile communication, joint design of sensing, communication and control in industrial cyber-physical systems, software-defined networking and network slicing, ultra-reliable low-latency communication, time-sensitive networking, and deep reinforcement learning. She has received many research grants as a Principal Investigator from the National Science Foundation of China.
Songtao Guo (Senior Member, IEEE) received the B.S., M.S. and Ph.D. degrees in computer software and theory from Chongqing University, Chongqing, China, in 1999, 2003 and 2008, respectively. He was a Professor with Chongqing University from 2011 to 2012 and with Southwest University from 2013 to 2018 . He is currently a Full Professor with Chongqing University. He was a Senior Research Associate with the City University of Hong Kong from 2010 to 2011, and a Visiting Scholar with Stony Brook University, Stony Brook, NY, USA, from May 2011 to May 2012. He has authored or coauthored more than 200 scientific papers in leading refereed journals and conferences. His research interests include wireless sensor networks, wireless ad hoc networks, and mobile edge computing. He has received many research grants as a Principal Investigator from the National Science Foundation of China and Chongqing and the Postdoctoral Science Foundation of China.
Chao Chen (Senior Member, IEEE) received the B.Sc. and M.Sc. degrees in control science and control engineering from Northwestern Polytechnical University, Xi’an, China, in 2007 and 2010, respectively, and the Ph.D. degree from Pierre and Marie Curie University, Paris, France, and Institut MinesTélécom/Télécom SudParis, France, in 2014. He is currently a Full Professor with the College of Computer Science, Chongqing University, Chongqing, China. He has authored or coauthored more than 80 papers including 20 ACM/IEEE Transactions. His research interests include pervasive computing, mobile computing, urban logistics, data mining from large-scale GPS trajectory data, and Big Data analytics for smart cities. His work on taxi trajectory data mining was featured by IEEE SPECTRUM in 2011, 2016, and 2020 respectively. He was the recipient of the Best Paper Runner-Up Award at MobiQuitous 2011.
Cailian Chen (Senior Member, IEEE) received the B. Eng. and M. Eng. degrees in automatic control from Yanshan University, Qinhuangdao, China, in 2000 and 2002, respectively, and the Ph.D. degree in control and systems from the City University of Hong Kong, Hong Kong SAR, in 2006. Since 2008, she has been with the Department of Automation, Shanghai Jiao Tong University, Shanghai, China. She is currently a Distinguished Professor. She has authored three research monographs and more than 100 referred international journal papers. She is the Inventor of more than 30 patents. Her research interests include industrial wireless networks and computational intelligence, and Internet of Vehicles. Dr. Chen was the recipient of the prestigious IEEE Transactions on Fuzzy Systems Outstanding Paper Award in 2008, IEEE TCCPS Industrial Technical Excellence Award in 2022, and five conference best paper awards. She was awarded N2Women Star in Computer Networking and Communications in 2022, and the Second Prize of National Natural Science Award from the State Council of China in 2018. She was honored National Outstanding Young Researcher by NSF of China in 2020. Dr. Chen has been actively involved in various professional services. She is a Distinguished Lecturer of IEEE VTS. She is the Deputy Editor of the National Science Open, and Associate Editor for IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY.
Xiaofeng Liao (Fellow, IEEE) received the B.S. and M.S. degrees in mathematics from Sichuan University, Chengdu, China, in 1986 and 1992, respectively, and the Ph.D. degree in circuits and systems from the University of Electronic Science and Technology of China, Chengdu, in 1997. From 1999 to 2012, he was a Professor with Chongqing University, Chongqing, China. From July 2012 to July 2018, he was a Professor and the Dean with the College of Electronic and Information Engineering, Southwest University, Chongqing. He is currently a Professor and the Dean with the College of Computer Science, Chongqing University. He is also a Yangtze River Scholar of the Ministry of Education of China, Beijing, China. From November 1997 to April 1998, he was a Research Associate with the Chinese University of Hong Kong, Hong Kong. From October 1999 to October 2000, he was a Research Associate with the City University of Hong Kong, Hong Kong. From March 2001 to June 2001 and March 2002 to June 2002, he was a Senior Research Associate with the City University of Hong Kong. From March 2006 to April 2007, he was a Research Fellow with the City University of Hong Kong. He has authored or coauthored four books and more than 300 international journal and conference papers. His research interests include decentralized optimization, machine learning, neural networks, and bifurcation and chaos cryptography. He is an Associate Editor for the IEEE TRANSACTIONS ON NEURAL NETWORKS AND LEARNING SYSTEMS.
Xinping Guan (Fellow, IEEE) received the B.Sc. degree in mathematics from Harbin Normal University, Harbin, China, in 1986, and the Ph.D. degree in control science and engineering from the Harbin Institute of Technology, Harbin, in 1999. He is currently a Chair Professor of Shanghai Jiao Tong University, Shanghai, China, where he is the Dean of School of Electronic, Information and Electrical Engineering, and the Director of the Key Laboratory of Systems Control and Information Processing, Ministry of Education of China. Before that, he was the Executive Director of Office of Research Management, Shanghai Jiao Tong University, a Full Professor and Dean of Electrical Engineering, Yanshan University, Qinhuangdao, China. He has authored and/or coauthored five research monographs, more than 200 papers in peer-reviewed journals, and numerous conference papers. His research interests include industrial network systems, smart manufacturing, and underwater networks. As a Principal Investigator, he has finished/been working on more than 20 National key projects. He is the Leader of the prestigious Innovative Research Team of the National Natural Science Foundation of China. Dr. Guan is an Executive Committee Member of Chinese Automation Association Council and the Chinese Artificial Intelligence Association Council. He was the recipient of the Second Prize of the National Natural Science Award of China in 2008 and 2018, First Prize of the Natural Science Award from the Ministry of Education of China in 2006 and 2016, and IEEE Transactions on Fuzzy Systems Outstanding Paper Award in 2008 and IEEE TCCPS Industrial Technical Excellence Award in 2022. He is a National Outstanding Youth honored by NSF of China, Changjiang Scholar by the Ministry of Education of China and State-level Scholar of New Century Bai Qianwan Talent Programof China. He was elected a Fellow of IEEE in 2018.
Authorized licensed use limited to: GUANGZHOU UNIVERSITY. Downloaded on September 25,2024 at 03:00:57 UTC from IEEE Xplore. Restrictions apply.